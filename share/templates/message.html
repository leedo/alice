? my ($app, $msg) = @_;
? my $avatar = ($msg->{avatar} and $app->config->{avatars} eq "show") ? $msg->{avatar} : "";
<li class="message <?= $msg->{highlight} ? "highlight " : "" ?><?= $avatar ? "avatar " : "" ?><?= $msg->{nick} ?><?= $msg->{self} ? " self" : "" ?><?= $msg->{consecutive} ? " consecutive" : "" ?><?= $msg->{monospaced} ? " monospace" : ""?>" id="<?= $msg->{msgid} ?>">
    <div class="left">
      <a href="javascript:alice.connection.requestWindow('<?= $msg->{nick} ?>','<?= $msg->{window}{id} ?>')" class="nick"<?= $msg->{source} ? " title=$msg->{source}" : "" ?>>
        <? if ($avatar) { ?>
          <img src="<?= $avatar ?>" alt="<?= $msg->{nick} ?>" />
          <span class="nickhint"><span class="nickborder">&lt;</span><?= $msg->{nick} ?><span class="nickborder">&gt;</span>
        <? } else { ?>
          <span class="nickborder">&lt;</span><?= $msg->{nick} ?><span class="nickborder">&gt;</span>
        <?}?>
      </a>
    </div>
    <div class="msg"><?= $msg->{html} ?></div>
    <? if (!$msg->{consecutive} and $msg->{timestamp}) { ?>
    <div class="timehint"><span class="timestamp"><?= $msg->{timestamp} ?></span></div>
    <? } ?>
</li>
